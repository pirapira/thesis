\chapter{The Logic of Information Exchange}
\label{ch:exchange}

\subsection{Summary}

The previous chapters treated the computational interpretations of
disjunctive formulas like $(\phi\imp\psi)\lor(\psi\imp\phi)$ or
$(\phi\limp\psi)\oplus(\psi\limp\phi)$.  In this chapter, we try
replacing these disjunctions into conjunctions.
In the former case, the change renders the logic inconsistent.
With the axiom $(\phi\imp\psi)\land(\psi\imp\phi)$,
we can prove any formula.  However in the lattar case, the change does
not make the system meaningless.  We treat
the axioms of the form $(\phi\limp\psi)\otimes(\psi\limp\phi)$
on top of IMLL2, the second order formulation of intuitionistic
multiplicative linear
logic.  In essence, the axiom allows two processes to wait for one
another and then exchange some pieces of information.

\subsection{Dynamics}

We define terms\index{term}~$t$ by BNF:
\[
 t ::= x\mid \lambda x.t\mid (t)t\enspace.
\]
By $t^+$ we denote a term of the form $x$, $\lambda x.t$, $c$ or $(t\conc
t)$.
We use $\Lambda$ for the set of terms.
A stack\index{stack}~$\pi$ and an executable\index{executable}~$e$
are defined by BNF:
\begin{align*}
 \pi &::= \epsilon\mid e\cdot\pi\\
 e   &::= t,\pi
\end{align*}
For two stacks $\sigma$ and $\pi$, $\sigma\cdot\pi$ is defined
inductively on $\sigma$: i.e. $\epsilon\cdot\pi = \pi$ and $(e
\cdot \sigma') \cdot \pi = e\cdot (\sigma'\cdot \pi)$.  By the latter
equation, $\cdot$ can be considered associative.
We use $\Pi$ for the set of stacks.
An executable is a multiset on $\Lambda\times \Pi$.

The reduction relation $\red$ is the smallest preorder on executables
that satisfies:
\begin{description}
 \item[(cong)] $e\red e'$ implies $t, \sigma \cdot e \cdot \pi\red
      t,\sigma\cdot e'\cdot \pi$ \enspace;
 \item[(push)]
	    $(t)u, \pi   \red t,(u,\epsilon)\cdot\pi$\enspace;
 \item[(store)]
	    $\lambda x.t,(u,\epsilon)\cdot\pi
	     \red
	     t[u/x], \pi$\enspace;
 \item[(ex)]
           $v, \pi\cdot (c, (t,\pi_0)\cdot \pi_1)\cdot\pi' \cdot (\co
      c,(u,\sigma_0)\cdot \sigma_1) \cdot \pi''\red
      v, \pi\cdot (u, \sigma_0\cdot \pi_1)\cdot\pi' \cdot (
      t,\pi_0\cdot \sigma_1) \cdot \pi''
      $
      \enspace.
\end{description}


\subsection{Statics}

We define an IMLL2 formula~$\phi$ by BNF:
\[
 \phi :: =
 X \mid
 \phi\limp\phi\mid
% \phi\otimes\phi\mid
 \forall X\phi\enspace.
\]
As abbreviations, we can introduce $\otimes$ and $\bot$:
\begin{align*}
 \phi\otimes\psi &\equiv \forall X ((\phi\limp\psi\limp X)\limp X)
 \text{ do not contain }\\
 \bot &\equiv \forall X X\enspace.
\end{align*}

The type system here employs conjunctive hypersequents.  Usually,
different components in a hypersequent are interpreted disjunctively.
However, components in a conjunctive hypersequent are interpreted
conjunctively by $\otimes$.

 \begin{figure}
\centering
\AxiomC{}
\LL  {Ax}
\useq{\xphi}{\xphi}
\DisplayProof
%
\hfill
\AxiomC{$\mathcal H$}
\AxiomC{$\mathcal H$}
\LL{mix}
\BinaryInfC{$\mathcal H\hmid \mathcal{H'}$}
\DisplayProof
%
\ruleskip
\aseq{\hyp{}\xphi,\G}{\tj t\psi}
\LL{$\limp$I}
\useq{\hyp{}\G}{\tj{\lambda x.t}{\phi\limp\psi}}
\DisplayProof
\hfill
%
\aseq{\hyp{}\G}{\tj t{\phi\limp\psi\hmid\D\tr\tj u\phi}}
\LL   {$\limp$E}
\useq{\hyp{}\G,\D}{\tj{(t)u}\psi}
\DisplayProof
\ruleskip
\aseq{\hyp{}\G}{\tj t\phi}
\LL   {$\forall$I}
\useq{\hyp{}\G}{\tj t{\forall X\phi}}
\DisplayProof (no free $X$ in $\mathcal H$ or $\G$)
\hfill
%
\aseq{\hyp{}\G}{\tj{t}{\forall X\phi}}
\LL   {$\forall$E}
\useq{\hyp{}\G}{\tj{t}{\phi[\psi/X]}}
\DisplayProof
\ruleskip
%
\aseq{\hyp{}\G}{\tj{t}{\phi}\hmid \D\tr\tj{u}{\psi}}
\LL  {com}
\useq{\hyp{}\G}{\tj{(c)t}{\psi}\hmid \D\tr\tj{(\co c)u}{\phi}}
\DisplayProof ($c$ is fresh)
\ruleskip
%
% \aseq{\hyp{}\G}{\tj{t}{\phi}\hmid \D\tr\tj{u}{\psi}}
%   \LL{$\otimes$I}
% \useq{\hyp{}\G,\D}{\tj{(t\conc u)}{\phi\otimes \psi}}
% \DisplayProof
%   %
%   \ruleskip
%   \aseq{\hyp{}\G}{\tj{t}{\phi\otimes\psi}\hmid
%   \tj{x}{\phi},\tj{y}{\psi},\D\tr \tj{u}{\theta}}
%   \LL{$\otimes$E}
%   \useq{\hyp{}\hyp'\G,\D}{\tj{\letpar t x y u}{\theta}}
%   \DisplayProof
  \caption{The typing rule of $\NMLL$.}
 \end{figure}

\subsection{Specification Using Poles}

% We define programs and environments in the same way as
% Subsection~\ref{pole:spec}.

\begin{definition}
 \label{ex:def:pole}
A pole\index{pole}~$\bbot$ is a set of executables
which satisfies
\begin{enumerate}
 \item \label{ex:red-closed} $e$ is in $\bbot$ if $e\red e'$ and
       $e'\in\bbot$; and
 \item \label{ex:conc-closed} $e\conc f$ is in $\bbot$ if $e$ and $f$ are in $\bbot$.
\end{enumerate}
\end{definition}

% leave until we see impE reqruires environments
% An environment\index{environment} is a pair of an s-stack and an s-executable.
% The set of environments is written as~$E$.
% A program\index{program} is a pair of an s-term and an s-executable.
For a set~$\mathcal Z$ of
%environments
stacks, $\mathcal Z\rightarrow\bbot$ denotes
the set of
terms
%$programs $(t,e)$
$t$ such that
for any
%environment $(\pi,e')\in \mathcal Z$,
stack $\pi\in\mathcal Z$,
the executable $t,\pi$ is in $\bbot$.
% We use programs and environments because if we continued using
% s-terms and s-stacks, the proof of adequacy (Thm.~\ref{c:adequacy})
% would fail
% in the case
% ($\limp$E,~\textminus),~\ref{c:second}.

For $\phi\in\form(2^E)$ and $|\cdot|^-_0\colon\pvar\rightarrow 2^E$\kern
-2pt,
we define $\nsem{\phi}\in
2^E$ inductively:
\begin{align*}
 \nsem{\mathcal Z} =& \mathcal Z \text{ for } \mathcal Z\in 2^E\\
 \nsem{X}=& |X|_0^- \\
 %%%
 \nsem{\phi\limp\psi}=&
 \{e\cdot\pi\mid  t\in\nsem\phi\rightarrow\bbot
 \text{ and  }\pi\in\nsem\psi\}\\
 %%%
 \nsem{\forall X\phi}=&
 \bigcup_{\mathcal Z\in 2^\sPi} \nsem{\phi[\mathcal Z/X]}\enspace.
\end{align*}
Using this, we define $\sem \phi=\nsem{\phi}\rightarrow\bbot$.
We have an equality
$\nsem{\phi\limp\psi} = \{t\cdot\pi\mid
t\in\sem\phi\text{ and }\pi\in\nsem\psi\}$.

For $\G = \tj{x_1}{\phi_1},\ldots,\tj{x_n}{\phi_n}$,
we denote by $\sem{\G}$ the set of sequences $\vec t$ where
$\vec{t} = (t_1,\dots,t_n)$
 and each term $t_i$ is in $\sem{\phi_i}$.
For that $\vec t$, $[\vec{t}/\G]$ denotes the simultaneous substitution
$[t_i/x_i]_{0\le i \le n}$.
For a hypersequent, we
define a set of s-executables
$
\semo{\G_0\tr\tj{t_0}{\phi_0}\hmid\cdots\hmid\G_n\tr\tj{t_n}{\phi_n}}
$
to be the set of executables of the form $\bigparallel_{0\le i\le
n}\left(t_i[\vec{g_i}/\G_i],\pi_i\right)$ where
$\vec{g_i} \in \sem{\G_i}$ and $\pi_i\in \nsem{\phi_i}$.

 \begin{theorem}[Adequacy]
  \fix{state}
 \end{theorem}
 \fix{prove}

  \begin{proposition}[Specification of the axiom]
   Let $g$ have type ${\forall X\forall
   Y((X\limp Y)\times (Y\limp X))}$.
   Then, the s-executable
   \[
   [g, \mats{z}{z}{x\cdot\pi_Y}{w}{w}{y\cdot\pi_X}]
   \]
   reduces to a multiset on
   $\{(x,\pi_X), (y,\pi_Y)\}$.
  \end{proposition}

\subsection{Consistency}

\begin{proposition}
  No term has the type $\forall X X$.
\end{proposition}
\begin{corollary}
 The system $\NMLL$ is consistent.
\end{corollary}
